<Page
    x:Class="Microsoft.Midi.Settings.Views.EndpointsAllPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:views="using:Microsoft.Midi.Settings.Views"
    xmlns:local="using:Microsoft.Midi.Settings.ViewModels"
    xmlns:midi2="using:Microsoft.Windows.Devices.Midi2"
    xmlns:midi2Reporting="using:Microsoft.Windows.Devices.Midi2.Reporting"
    xmlns:helpers="using:Microsoft.Midi.Settings.Helpers"
    xmlns:controls="using:CommunityToolkit.WinUI.Controls"
    xmlns:midicontrols="using:Microsoft.Midi.Settings.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    >

    <Page.Resources>
        <ResourceDictionary>
            <helpers:HasUniqueIdToVisibilityConverter x:Key="HasUniqueIdToVisibilityConverter" />
            <helpers:HasUniqueIdToInverseVisibilityConverter x:Key="HasUniqueIdToInverseVisibilityConverter" />
            <helpers:MidiEndpointNativeDataFormatConverter x:Key="MidiEndpointNativeDataFormatConverter" />
            <helpers:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
            <helpers:BooleanToEmojiCheckConverter x:Key="BooleanToEmojiCheckConverter" />

            <Style x:Key="MidiFeatureTagText" TargetType="TextBlock">
                <Setter Property="Foreground" Value="Black" />
                <Setter Property="FontSize" Value="9" />
                <Setter Property="FontWeight" Value="Bold" />
                <Setter Property="Margin" Value="4,2,4,2" />
                <Setter Property="Opacity" Value="1" />
            </Style>

            <Style x:Key="MidiFeatureTagContainerBase" TargetType="Grid">
                <Setter Property="Margin" Value="4,2,4,2" />
                <Setter Property="Opacity" Value="1" />
                <Setter Property="CornerRadius" Value="{StaticResource ControlCornerRadius}" />
                <Setter Property="BorderThickness" Value="1" />
                <Setter Property="BorderBrush" Value="{StaticResource CircleElevationBorderBrush}" />
            </Style>

            <Style x:Key="MidiFeatureTagContainerGood" TargetType="Grid" BasedOn="{StaticResource MidiFeatureTagContainerBase}">
                <Setter Property="Background" Value="#CCF0F0F0" />
            </Style>

            <Style x:Key="MidiFeatureTagContainerNeutral" TargetType="Grid" BasedOn="{StaticResource MidiFeatureTagContainerBase}">
                <Setter Property="Background" Value="#CCA0A0A0" />
            </Style>

            <Style x:Key="MidiFeatureTagContainerCaution" TargetType="Grid" BasedOn="{StaticResource MidiFeatureTagContainerBase}">
                <Setter Property="Background" Value="{StaticResource SystemFillColorCautionBrush}" />
            </Style>

            <Style x:Key="MidiFeatureTagContainerBad" TargetType="Grid" BasedOn="{StaticResource MidiFeatureTagContainerBase}">
                <Setter Property="Background" Value="{StaticResource SystemFillColorCriticalBrush}" />
            </Style>

            <GridLength x:Key="Midi1PortListPortNumberColumnWidth">25</GridLength>

            <!-- MIDI 1 ports flyout -->
            <DataTemplate x:Key="Midi1FlyoutPortTemplate" 
                          x:DataType="midi2:MidiEndpointAssociatedPortDeviceInformation">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="{StaticResource Midi1PortListPortNumberColumnWidth}" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                   
                    <TextBlock Grid.Column="0" 
                               Text="{x:Bind PortNumber}" 
                               TextAlignment="Left" 
                               Foreground="{StaticResource TextFillColorDisabledBrush}"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Left"/>

                    <TextBlock Grid.Column="1" 
                               Text="{x:Bind PortName}" 
                               Foreground="{StaticResource SystemFillColorAttentionBrush}"
                               />
                </Grid>
            </DataTemplate>


        </ResourceDictionary>
    </Page.Resources>

    <Grid x:Name="ContentArea">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Page Title -->
        <TextBlock Grid.Row="0" x:Uid="DevicesPage_Description" Margin="0,0,0,0" />

        <!-- View type, Sort, and Filter -->

        <Grid Grid.Row="1">
            <CommandBar HorizontalAlignment="Left"
                        Margin="0,0,0,8"
                        IsOpen="False"
                        DefaultLabelPosition="Right"
                        IsDynamicOverflowEnabled="False">
                <CommandBar.PrimaryCommands>
                    
                    <!-- Cards, Icons, or List -->

                    <AppBarToggleButton x:Name="ViewCardsButton"
                                        VerticalAlignment="Center"
                                        Label="Cards"
                                        IsChecked="{x:Bind ViewModel.UseCardView, Mode=TwoWay}">
                        <AppBarToggleButton.Icon>
                            <FontIcon Glyph="&#xE737;" />
                        </AppBarToggleButton.Icon>
                    </AppBarToggleButton>
                    
                    <AppBarToggleButton x:Name="ViewListButton"
                                        Label="List"
                                        IsChecked="{x:Bind ViewModel.UseListView, Mode=TwoWay}">
                        <AppBarToggleButton.Icon>
                            <FontIcon Glyph="&#xE8FD;" />
                        </AppBarToggleButton.Icon>

                    </AppBarToggleButton>

                    <AppBarSeparator/>

                    <!-- Filter by transport -->
                    <AppBarElementContainer VerticalAlignment="Center">
                        <ComboBox ItemsSource="{x:Bind ViewModel.Transports, Mode=OneTime}"
                                  SelectedItem="{x:Bind ViewModel.SelectedTransport, Mode=TwoWay}"
                                  FontSize="{StaticResource SmallFontSize}"
                                  Margin="8,0,8,0"
                                  VerticalAlignment="Bottom">
                            <ComboBox.ItemTemplate>
                                <DataTemplate x:DataType="local:TransportFilterEntry">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="{x:Bind Name}"/>

                                        <TextBlock Text="(" Margin="4,0,0,0"  />
                                        <TextBlock Text="{x:Bind TransportCode}" Opacity="0.5"/>
                                        <TextBlock Text=")"/>
                                    </StackPanel>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                    </AppBarElementContainer>
                    
                    
                    
                </CommandBar.PrimaryCommands>
            </CommandBar>
           
        </Grid>


        <!-- Endpoint List - List View -->
        <ScrollView Grid.Row="2"
                    Visibility="{x:Bind ViewModel.UseListView, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}">

            <Grid Margin="0,0,0,0" HorizontalAlignment="Stretch">
                <ListView ItemsSource="{x:Bind ViewModel.Endpoints, Mode=OneWay}"
                          SelectionMode="None"
                          IsItemClickEnabled="True"    
                          ItemClick="GridView_ItemClick">
                    <ListView.ItemContainerStyle>
                        <Style TargetType="ListViewItem" BasedOn="{StaticResource DefaultListViewItemStyle}">
                            <Setter Property="Margin" Value="0,4,0,4"/>
                            <Setter Property="Padding" Value="0"/>
                        </Style>
                    </ListView.ItemContainerStyle>

                    <ListView.ItemTemplate>
                        <DataTemplate x:DataType="local:MidiEndpointWrapper">

                            <Grid>
                                <Border HorizontalAlignment="Stretch"
                                        VerticalAlignment="Stretch"
                                        CornerRadius="{StaticResource ControlCornerRadius}"
                                        Opacity="0.2">
                                    <Border.Background>
                                        <LinearGradientBrush>
                                            <GradientStop Offset="0" Color="Transparent" />
                                            <GradientStop Offset="1" Color="{StaticResource SolidBackgroundFillColorSecondary}" />
                                        </LinearGradientBrush>
                                    </Border.Background>
                                </Border>

                                <Border HorizontalAlignment="Stretch"
                                        VerticalAlignment="Stretch"
                                        CornerRadius="{StaticResource ControlCornerRadius}"
                                        Background="{StaticResource LayerFillColorAltBrush}"
                                        BorderBrush="{StaticResource CardStrokeColorDefaultBrush}"
                                        BorderThickness="1"/>

                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />   <!-- Icon -->
                                        <ColumnDefinition Width="2*" />     <!-- Name and Description -->
                                        <ColumnDefinition Width="*" />      <!-- MIDI 1.0 Ports -->
                                        <ColumnDefinition Width="Auto"/>    <!-- Actions -->
                                    </Grid.ColumnDefinitions>

                                    <!-- Icon -->
                                    <ImageIcon Grid.Column="0" 
                                               Source="{x:Bind SmallImage}" 
                                               Width="60" Height="60"
                                               Margin="8"/>

                                    <!-- Name and Description + property chicklets -->
                                    <Grid Grid.Column="1" 
                                          Margin="8">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>

                                        <!-- Name -->
                                        <StackPanel Grid.Row="0" Orientation="Horizontal">
                                            <TextBlock Text="{x:Bind Name}" 
                                                       Style="{StaticResource SmallEmphasizedPropertyValueNoTrim}"/>
                                            <TextBlock Opacity="0.5"
                                                       Style="{StaticResource SmallPlainPropertyValue}"
                                                       Visibility="{x:Bind HasManufacturerName, Converter={StaticResource BooleanToVisibilityConverter}}">
                                            <Run Text=" by " />
                                            <Run Text="{x:Bind ManufacturerName}" />
                                            </TextBlock>
                                        </StackPanel>

                                        <!-- Description -->
                                        <TextBlock Grid.Row="1" 
                                                   Style="{StaticResource SmallPlainPropertyValueWithWrap}"
                                                   Text="{x:Bind Description}"/>

                                        <!-- Key properties -->
                                        <Grid Grid.Row="2">
                                            <StackPanel Orientation="Horizontal">
                                                <Grid Style="{StaticResource MidiFeatureTagContainerNeutral}"
                                                  Visibility="{x:Bind IsNativeUmp, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}">
                                                    <TextBlock Text="UMP Data Format" Style="{StaticResource MidiFeatureTagText}"/>
                                                    <ToolTipService.ToolTip>
                                                        <TextBlock TextWrapping="WrapWholeWords" Text="This endpoint uses the new UMP data format, natively." />
                                                    </ToolTipService.ToolTip>
                                                </Grid>

                                                <Grid Style="{StaticResource MidiFeatureTagContainerGood}"
                                                  Visibility="{x:Bind SupportsMidi2, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}">
                                                    <TextBlock Text="MIDI 2.0" Style="{StaticResource MidiFeatureTagText}"/>
                                                    <ToolTipService.ToolTip>
                                                        <TextBlock TextWrapping="WrapWholeWords" Text="This endpoint supports the MIDI 2.0 protocol, including high-resolution values." />
                                                    </ToolTipService.ToolTip>
                                                </Grid>

                                                <Grid Style="{StaticResource MidiFeatureTagContainerNeutral}"
                                                  Visibility="{x:Bind IsNativeUmp, Mode=OneWay, Converter={StaticResource BooleanToInverseVisibilityConverter}}">
                                                    <TextBlock Text="MIDI 1.0 Byte Format" Style="{StaticResource MidiFeatureTagText}"/>
                                                    <ToolTipService.ToolTip>
                                                        <TextBlock TextWrapping="WrapWholeWords" Text="This endpoint uses the classic MIDI 1.0 byte format" />
                                                    </ToolTipService.ToolTip>
                                                </Grid>


                                                <Grid Style="{StaticResource MidiFeatureTagContainerGood}"
                                                  Visibility="{x:Bind HasUniqueIdentifier, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}">
                                                    <TextBlock Text="Unique Id" Style="{StaticResource MidiFeatureTagText}"/>
                                                    <ToolTipService.ToolTip>
                                                        <TextBlock TextWrapping="WrapWholeWords" Text="This endpoint has a serial number or other unique id, making it easier to keep customizations attached." />
                                                    </ToolTipService.ToolTip>
                                                </Grid>
                                                <Grid Style="{StaticResource MidiFeatureTagContainerNeutral}"
                                                  Visibility="{x:Bind HasUniqueIdentifier, Mode=OneWay, Converter={StaticResource BooleanToInverseVisibilityConverter}}">
                                                    <TextBlock Text="No Unique Id" Style="{StaticResource MidiFeatureTagText}"/>
                                                    <ToolTipService.ToolTip>
                                                        <TextBlock TextWrapping="WrapWholeWords" Text="This endpoint does not have a serial number or unique id. Customizations may be lost if you change the device connection." />
                                                    </ToolTipService.ToolTip>
                                                </Grid>


                                                <Grid Style="{StaticResource MidiFeatureTagContainerGood}"
                                                  Visibility="{x:Bind IsMultiClient, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}">
                                                    <TextBlock Text="Multi-client" Style="{StaticResource MidiFeatureTagText}"/>
                                                    <ToolTipService.ToolTip>
                                                        <TextBlock TextWrapping="WrapWholeWords" Text="More than one application can use this endpoint at the same time." />
                                                    </ToolTipService.ToolTip>
                                                </Grid>
                                                <Grid Style="{StaticResource MidiFeatureTagContainerBad}"
                                                  Visibility="{x:Bind IsMultiClient, Mode=OneWay, Converter={StaticResource BooleanToInverseVisibilityConverter}}">
                                                    <TextBlock Text="Single-client" Style="{StaticResource MidiFeatureTagText}"/>
                                                    <ToolTipService.ToolTip>
                                                        <TextBlock TextWrapping="WrapWholeWords" Text="This endpoint is restricted to a single application at a time." />
                                                    </ToolTipService.ToolTip>
                                                </Grid>


                                            </StackPanel>

                                        </Grid>


                                    </Grid>

                                    <!-- MIDI 1 Ports -->
                                    <Grid Grid.Column="2"
                                          VerticalAlignment="Center">

                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>

                                        <TextBlock Grid.Row="0" 
                                                   Text="MIDI 1.0 API Ports"
                                                   FontSize="{StaticResource SmallFontSize}"
                                                   Margin="4,4,0,4"
                                                   FontWeight="Bold"/>

                                        <TextBlock Grid.Row="1" 
                                                   Visibility="{x:Bind HasSingleInputPort, Mode=OneWay, Converter={StaticResource BooleanToInverseVisibilityConverter}}"
                                                   Style="{StaticResource SmallPropertyLabel}">
                                            <Run Text="{x:Bind CountMidi1InputPorts, Mode=OneWay}" />
                                            <Run Text="Sources/Inputs" />
                                            
                                            <ToolTipService.ToolTip>
                                                <StackPanel Orientation="Vertical" Margin="8">
                                                    <TextBlock Margin="8" Text="MIDI 1.0 API Sources/Inputs"/>
                                                    <ItemsControl Margin="8" 
                                                                  ItemsSource="{x:Bind Midi1InputPorts, Mode=OneWay}" 
                                                                  ItemTemplate="{StaticResource Midi1FlyoutPortTemplate}"/>
                                                </StackPanel>
                                            </ToolTipService.ToolTip>
                                        </TextBlock>

                                        <Grid Grid.Row="1"
                                              Visibility="{x:Bind HasSingleInputPort, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="120" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>

                                            <TextBlock Grid.Column="0"
                                                       Text="Source/Input"
                                                       Style="{StaticResource SmallPropertyLabel}"/>
                                            <TextBlock Grid.Column="1"
                                                       Text="{x:Bind SingleInputPortName, Mode=OneWay}"
                                                       Style="{StaticResource SmallEmphasizedPropertyValueNoTrim}"
                                                       Foreground="{StaticResource SystemFillColorAttentionBrush}"/>
                                        </Grid>



                                        <TextBlock Grid.Row="2" 
                                                   Visibility="{x:Bind HasSingleOutputPort, Mode=OneWay, Converter={StaticResource BooleanToInverseVisibilityConverter}}"
                                               Style="{StaticResource SmallPropertyLabel}">
                                            <Run Text="{x:Bind CountMidi1OutputPorts, Mode=OneWay}" />
                                            <Run Text="Destinations/Outputs" />
                                            
                                            <ToolTipService.ToolTip>
                                                <StackPanel Orientation="Vertical" Margin="8">
                                                    <TextBlock Margin="8" Text="MIDI 1.0 API Destinations/Outputs"/>
                                                    <ItemsControl Margin="8" ItemsSource="{x:Bind Midi1OutputPorts, Mode=OneWay}" 
                                                                  ItemTemplate="{StaticResource Midi1FlyoutPortTemplate}"/>
                                                </StackPanel>

                                            </ToolTipService.ToolTip>
                                        </TextBlock>

                                        <Grid Grid.Row="2"
                                              Visibility="{x:Bind HasSingleOutputPort, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="120" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>

                                            <TextBlock Grid.Column="0" 
                                                       Text="Destination/Output"
                                                       Style="{StaticResource SmallPropertyLabel}"/>
                                            <TextBlock Grid.Column="1"
                                                       Text="{x:Bind SingleOutputPortName, Mode=OneWay}"
                                                       Style="{StaticResource SmallEmphasizedPropertyValueNoTrim}"
                                                       Foreground="{StaticResource SystemFillColorAttentionBrush}"/>
                                        </Grid>


                                    </Grid>


                                    <!-- Actions -->
                                    <StackPanel Grid.Column="3" 
                                                Orientation="Horizontal"
                                                VerticalAlignment="Center"
                                                Margin="16" 
                                                Spacing="16">
                                        <Button Content="Panic"
                                                Command="{x:Bind SendPanicCommand}">

                                            <ToolTipService.ToolTip>
                                                <TextBlock TextWrapping="WrapWholeWords"
                                                            Text="Send All Notes Off, All Sound Off, and Reset All Controllers messages to all groups and channels on the endpoint. NOTE: Not all MIDI devices respond to these messages."/>
                                            </ToolTipService.ToolTip>
                                        </Button>

                                        <Button Content="Monitor"/>
                                    </StackPanel>



                                </Grid>
                            </Grid>
                            

                        </DataTemplate>
                    </ListView.ItemTemplate>

                </ListView>


            </Grid>

        </ScrollView>


        <!-- Endpoint List - Card View -->
        <ScrollViewer Grid.Row="2"
                      Visibility="{x:Bind ViewModel.UseCardView, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}">


            <Grid Margin="-8,0,0,0" HorizontalAlignment="Stretch">
                <GridView ItemsSource="{x:Bind ViewModel.Endpoints, Mode=OneWay}"
                          SelectionMode="None"
                          IsItemClickEnabled="True"                         
                          ItemClick="GridView_ItemClick">
                    <GridView.ItemContainerStyle>
                        <Style TargetType="GridViewItem" BasedOn="{StaticResource DefaultGridViewItemStyle}">
                            <Setter Property="Margin" Value="8"/>
                        </Style>
                    </GridView.ItemContainerStyle>
                    
                    <GridView.ItemTemplate>
                        <DataTemplate x:DataType="local:MidiEndpointWrapper">

                            <Grid CornerRadius="{StaticResource ControlCornerRadius}"
                                  Margin="1"
                                  Width="350"
                                  Height="310">

                                <Border HorizontalAlignment="Stretch"
                                        VerticalAlignment="Stretch"
                                        CornerRadius="{StaticResource ControlCornerRadius}"
                                        Opacity="0.2">
                                    <Border.Background>
                                        <LinearGradientBrush>
                                            <GradientStop Offset="0" Color="Transparent" />
                                            <GradientStop Offset="1" Color="{StaticResource SolidBackgroundFillColorSecondary}" />
                                        </LinearGradientBrush>
                                    </Border.Background>
                                </Border>

                                <Border HorizontalAlignment="Stretch"
                                        VerticalAlignment="Stretch"
                                        CornerRadius="{StaticResource ControlCornerRadius}"
                                        Background="{StaticResource LayerFillColorAltBrush}"
                                        BorderBrush="{StaticResource CardStrokeColorDefaultBrush}"
                                        BorderThickness="1"/>

                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>


                                    <Grid Grid.Row="0" 
                                          Padding="16,16,16,8">

                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="*" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>

                                        <Grid Grid.Row="0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="90" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>

                                            <Image Grid.Column="0"
                                               Grid.RowSpan="3"
                                               Margin="0,0,16,16"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Top"
                                               Source="{x:Bind SmallImage}"
                                               Stretch="Uniform"/>



                                            <!-- Name -->
                                            <TextBlock Text="{x:Bind Name}" 
                                                   Grid.Row="0"
                                                   Grid.Column="1"
                                                   Margin="4,0,4,8"
                                                   Style="{StaticResource EndpointCardNameStyle}" />


                                            <!-- Description -->
                                            <TextBlock Grid.Row="1" 
                                                   Grid.Column="1"
                                                   Margin="4,0,4,4"
                                                   VerticalAlignment="Top"
                                                   Text="{x:Bind Description}"
                                                   Style="{StaticResource EndpointCardDescriptionStyle}" />

                                            <!-- Manufacturer Name -->
                                            <TextBlock Text="{x:Bind ManufacturerName}" 
                                                   Visibility="{x:Bind HasManufacturerName, Converter={StaticResource BooleanToVisibilityConverter}}"
                                                   Grid.Row="2"
                                                   Grid.Column="1"
                                                   Margin="4"
                                                   Opacity="0.5" />

                                        </Grid>



                                        <Grid Grid.Row="1"
                                          Margin="0,4,0,8"
                                          VerticalAlignment="Bottom">

                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>

                                            <TextBlock Grid.Row="0" 
                                                   Text="MIDI 1.0 API Ports"
                                                   FontSize="{StaticResource SmallFontSize}"
                                                   Margin="4,4,0,4"
                                                   FontWeight="Bold"/>

                                            <TextBlock Grid.Row="1" 
                                                   Visibility="{x:Bind HasSingleInputPort, Mode=OneWay, Converter={StaticResource BooleanToInverseVisibilityConverter}}"
                                                   Style="{StaticResource SmallPropertyLabel}">
                                            <Run Text="{x:Bind CountMidi1InputPorts, Mode=OneWay}" />
                                            <Run Text="Sources/Inputs" />
                                            
                                            <ToolTipService.ToolTip>
                                                <StackPanel Orientation="Vertical" Margin="8">
                                                    <TextBlock Margin="8" Text="MIDI 1.0 API Sources/Inputs"/>
                                                    <ItemsControl Margin="8" 
                                                                  ItemsSource="{x:Bind Midi1InputPorts, Mode=OneWay}" 
                                                                  ItemTemplate="{StaticResource Midi1FlyoutPortTemplate}"/>
                                                </StackPanel>
                                            </ToolTipService.ToolTip>
                                        </TextBlock>

                                            <Grid Grid.Row="1"
                                              Visibility="{x:Bind HasSingleInputPort, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="120" />
                                                    <ColumnDefinition Width="*" />
                                                </Grid.ColumnDefinitions>

                                                <TextBlock Grid.Column="0"
                                                       Text="Source/Input"
                                                       Style="{StaticResource SmallPropertyLabel}"/>
                                                <TextBlock Grid.Column="1"
                                                       Text="{x:Bind SingleInputPortName, Mode=OneWay}"
                                                       Style="{StaticResource SmallEmphasizedPropertyValueNoTrim}"
                                                       Foreground="{StaticResource SystemFillColorAttentionBrush}"/>
                                            </Grid>



                                            <TextBlock Grid.Row="2" 
                                                   Visibility="{x:Bind HasSingleOutputPort, Mode=OneWay, Converter={StaticResource BooleanToInverseVisibilityConverter}}"
                                               Style="{StaticResource SmallPropertyLabel}">
                                            <Run Text="{x:Bind CountMidi1OutputPorts, Mode=OneWay}" />
                                            <Run Text="Destinations/Outputs" />
                                            
                                            <ToolTipService.ToolTip>
                                                <StackPanel Orientation="Vertical" Margin="8">
                                                    <TextBlock Margin="8" Text="MIDI 1.0 API Destinations/Outputs"/>
                                                    <ItemsControl Margin="8" ItemsSource="{x:Bind Midi1OutputPorts, Mode=OneWay}" 
                                                                  ItemTemplate="{StaticResource Midi1FlyoutPortTemplate}"/>
                                                </StackPanel>

                                            </ToolTipService.ToolTip>
                                        </TextBlock>

                                            <Grid Grid.Row="2"
                                              Visibility="{x:Bind HasSingleOutputPort, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="120" />
                                                    <ColumnDefinition Width="*" />
                                                </Grid.ColumnDefinitions>

                                                <TextBlock Grid.Column="0" 
                                                       Text="Destination/Output"
                                                       Style="{StaticResource SmallPropertyLabel}"/>
                                                <TextBlock Grid.Column="1"
                                                       Text="{x:Bind SingleOutputPortName, Mode=OneWay}"
                                                       Style="{StaticResource SmallEmphasizedPropertyValueNoTrim}"
                                                       Foreground="{StaticResource SystemFillColorAttentionBrush}"/>
                                            </Grid>


                                        </Grid>


                                        <Grid Grid.Row="2"
                                          Margin="0,8,0,8">
                                            <StackPanel Orientation="Horizontal">
                                                <Grid Style="{StaticResource MidiFeatureTagContainerNeutral}"
                                                  Visibility="{x:Bind IsNativeUmp, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}">
                                                    <TextBlock Text="UMP Data Format" Style="{StaticResource MidiFeatureTagText}"/>
                                                    <ToolTipService.ToolTip>
                                                        <TextBlock TextWrapping="WrapWholeWords" Text="This endpoint uses the new UMP data format, natively." />
                                                    </ToolTipService.ToolTip>
                                                </Grid>

                                                <Grid Style="{StaticResource MidiFeatureTagContainerGood}"
                                                  Visibility="{x:Bind SupportsMidi2, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}">
                                                    <TextBlock Text="MIDI 2.0" Style="{StaticResource MidiFeatureTagText}"/>
                                                    <ToolTipService.ToolTip>
                                                        <TextBlock TextWrapping="WrapWholeWords" Text="This endpoint supports the MIDI 2.0 protocol, including high-resolution values." />
                                                    </ToolTipService.ToolTip>
                                                </Grid>

                                                <Grid Style="{StaticResource MidiFeatureTagContainerNeutral}"
                                                  Visibility="{x:Bind IsNativeUmp, Mode=OneWay, Converter={StaticResource BooleanToInverseVisibilityConverter}}">
                                                    <TextBlock Text="MIDI 1.0 Byte Format" Style="{StaticResource MidiFeatureTagText}"/>
                                                    <ToolTipService.ToolTip>
                                                        <TextBlock TextWrapping="WrapWholeWords" Text="This endpoint uses the classic MIDI 1.0 byte format" />
                                                    </ToolTipService.ToolTip>
                                                </Grid>


                                                <Grid Style="{StaticResource MidiFeatureTagContainerGood}"
                                                  Visibility="{x:Bind HasUniqueIdentifier, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}">
                                                    <TextBlock Text="Unique Id" Style="{StaticResource MidiFeatureTagText}"/>
                                                    <ToolTipService.ToolTip>
                                                        <TextBlock TextWrapping="WrapWholeWords" Text="This endpoint has a serial number or other unique id, making it easier to keep customizations attached." />
                                                    </ToolTipService.ToolTip>
                                                </Grid>
                                                <Grid Style="{StaticResource MidiFeatureTagContainerNeutral}"
                                                  Visibility="{x:Bind HasUniqueIdentifier, Mode=OneWay, Converter={StaticResource BooleanToInverseVisibilityConverter}}">
                                                    <TextBlock Text="No Unique Id" Style="{StaticResource MidiFeatureTagText}"/>
                                                    <ToolTipService.ToolTip>
                                                        <TextBlock TextWrapping="WrapWholeWords" Text="This endpoint does not have a serial number or unique id. Customizations may be lost if you change the device connection." />
                                                    </ToolTipService.ToolTip>
                                                </Grid>


                                                <Grid Style="{StaticResource MidiFeatureTagContainerGood}"
                                                  Visibility="{x:Bind IsMultiClient, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}">
                                                    <TextBlock Text="Multi-client" Style="{StaticResource MidiFeatureTagText}"/>
                                                    <ToolTipService.ToolTip>
                                                        <TextBlock TextWrapping="WrapWholeWords" Text="More than one application can use this endpoint at the same time." />
                                                    </ToolTipService.ToolTip>
                                                </Grid>
                                                <Grid Style="{StaticResource MidiFeatureTagContainerBad}"
                                                  Visibility="{x:Bind IsMultiClient, Mode=OneWay, Converter={StaticResource BooleanToInverseVisibilityConverter}}">
                                                    <TextBlock Text="Single-client" Style="{StaticResource MidiFeatureTagText}"/>
                                                    <ToolTipService.ToolTip>
                                                        <TextBlock TextWrapping="WrapWholeWords" Text="This endpoint is restricted to a single application at a time." />
                                                    </ToolTipService.ToolTip>
                                                </Grid>


                                            </StackPanel>

                                        </Grid>


                                    </Grid>


                                    <Border HorizontalAlignment="Stretch"
                                            VerticalAlignment="Stretch"
                                            Grid.Row="1"                                           
                                            Background="{StaticResource SolidBackgroundFillColorBaseBrush}"
                                            Opacity="0.3"/>

                                    <!-- Actions -->
                                    <Grid Grid.Row="1"
                                          Padding="12,8,12,8"
                                          VerticalAlignment="Center">

                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>

                                        <StackPanel Grid.Column="0"
                                                Orientation="Horizontal"
                                                HorizontalAlignment="Left">
                                            <Button Content="Panic"
                                                    Margin="4,8,4,8"
                                                    Command="{x:Bind SendPanicCommand}">

                                                <ToolTipService.ToolTip>
                                                    <TextBlock TextWrapping="WrapWholeWords"
                                                               Text="Send All Notes Off, All Sound Off, and Reset All Controllers messages to all groups and channels on the endpoint. NOTE: Not all MIDI devices respond to these messages."/>
                                                </ToolTipService.ToolTip>
                                            </Button>

                                        </StackPanel>

                                        <StackPanel Grid.Column="1" 
                                                Orientation="Horizontal"
                                                HorizontalAlignment="Right">

                                            <Button Content="Monitor" Margin="4,8,4,8" />

                                            <!--<Button Content="Details >" Margin="4,8,4,8"
                                                Command="{x:Bind ViewDeviceDetailsCommand }"
                                                CommandParameter="{x:Bind DeviceInformation }"
                                                />-->

                                            <!--<Button Content="..." Margin="4,8,8,8">
                                            <Button.Flyout>
                                                <MenuFlyout>
                                                    <MenuFlyoutItem>Send Program Change</MenuFlyoutItem>
                                                    <MenuFlyoutItem>Send Control Change</MenuFlyoutItem>
                                                    <MenuFlyoutSeparator/>
                                                    <MenuFlyoutItem>Send MIDI Start</MenuFlyoutItem>
                                                    <MenuFlyoutItem>Send MIDI Stop</MenuFlyoutItem>
                                                    <MenuFlyoutSeparator/>
                                                    <MenuFlyoutItem>Send SysEx</MenuFlyoutItem>
                                                    <MenuFlyoutSeparator/>
                                                    <MenuFlyoutItem>Send Test Messages</MenuFlyoutItem>
                                                    <MenuFlyoutItem>MIDI Panic</MenuFlyoutItem>
                                                </MenuFlyout>
                                            </Button.Flyout>
                                        </Button>-->

                                        </StackPanel>

                                    </Grid>
                                </Grid>



                            </Grid>
                            
                        </DataTemplate>
                    </GridView.ItemTemplate>
                    
                </GridView>
                

            </Grid>

            
        </ScrollViewer>

    </Grid>

</Page>

