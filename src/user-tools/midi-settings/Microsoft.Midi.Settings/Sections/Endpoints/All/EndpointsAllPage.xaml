<Page
    x:Class="Microsoft.Midi.Settings.Views.EndpointsAllPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:views="using:Microsoft.Midi.Settings.Views"
    xmlns:local="using:Microsoft.Midi.Settings.ViewModels"
    xmlns:midi2="using:Microsoft.Windows.Devices.Midi2"
    xmlns:helpers="using:Microsoft.Midi.Settings.Helpers"
    xmlns:controls="using:CommunityToolkit.WinUI.Controls"
    xmlns:midicontrols="using:Microsoft.Midi.Settings.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    >

    <Page.Resources>
        <ResourceDictionary>
            <helpers:HasUniqueIdToVisibilityConverter x:Key="HasUniqueIdToVisibilityConverter" />
            <helpers:HasUniqueIdToInverseVisibilityConverter x:Key="HasUniqueIdToInverseVisibilityConverter" />
            <helpers:MidiEndpointNativeDataFormatConverter x:Key="MidiEndpointNativeDataFormatConverter" />
            <helpers:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
            <helpers:BooleanToEmojiCheckConverter x:Key="BooleanToEmojiCheckConverter" />

            <Style x:Key="FeatureTag" TargetType="TextBlock">
                <Setter Property="FontSize" Value="9" />
                <!-- <Setter Property="Foreground" Value="Black" /> -->
                <Setter Property="FontWeight" Value="Bold" />
                <Setter Property="Margin" Value="8,4,8,4" />
                <Setter Property="Opacity" Value="0.75" />
            </Style>

            <GridLength x:Key="Midi1PortListPortNumberColumnWidth">35</GridLength>

            <!-- MIDI 1 input ports flyout -->
            <DataTemplate x:Key="Midi1InputPortTemplate" x:DataType="midi2:MidiEndpointAssociatedPortDeviceInformation">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="{StaticResource Midi1PortListPortNumberColumnWidth}" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                   
                    <TextBlock Grid.Column="0" 
                               Text="{x:Bind PortNumber}" 
                               TextAlignment="Center" 
                               Foreground="{StaticResource TextFillColorDisabledBrush}"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Center"/>

                    <TextBlock Grid.Column="1" 
                               Text="{x:Bind PortName}" />
                </Grid>
            </DataTemplate>

            <!-- MIDI 1 output ports flyout -->
            <DataTemplate x:Key="Midi1OutputPortTemplate" x:DataType="midi2:MidiEndpointAssociatedPortDeviceInformation">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="{StaticResource Midi1PortListPortNumberColumnWidth}" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="0" Text="{x:Bind PortNumber}" Margin="2"/>
                    <TextBlock Grid.Column="1" Text="{x:Bind PortName}" Margin="2"/>
                </Grid>
            </DataTemplate>




        </ResourceDictionary>
    </Page.Resources>

    <Grid x:Name="ContentArea">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Page Title -->
        <TextBlock Grid.Row="0" x:Uid="DevicesPage_Description" Margin="0,0,0,0" />

        <!-- View type, Sort, and Filter -->

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <!-- Cards, Icons, or List -->
            <StackPanel Orientation="Horizontal"
                        Grid.Column="0"
                        Margin="8">

                <ToggleButton x:Name="ViewCardsButton">
                    <ToggleButton.Content>
                        <FontIcon Glyph="&#xE737;" />
                    </ToggleButton.Content>
                </ToggleButton>

                <ToggleButton x:Name="ViewListButton">
                    <ToggleButton.Content>
                        <FontIcon Glyph="&#xE8FD;" />
                    </ToggleButton.Content>
                </ToggleButton>

            </StackPanel>

            <!-- Sort order combo and button  -->
            <StackPanel Orientation="Horizontal"
                        Grid.Column="1"
                        Margin="8">
                <ComboBox Width="150"
                          Header="Sort">
                    <ComboBox.Items>
                        <x:String>Endpoint Name</x:String>
                        <x:String>Transport Type</x:String>
                        <x:String>Last Update Time</x:String>
                    </ComboBox.Items>
                </ComboBox>
            </StackPanel>
            
            <!-- Filter / Search by any names in the endpoint -->
            
            <AutoSuggestBox Grid.Column="2"
                            Width="250"
                            Margin="8"
                            QueryIcon="Find"
                            MinWidth="200"                            
                            Header="Find Endpoint"
                            Text="{x:Bind ViewModel.FilterString, Mode=TwoWay}"
                            >
                
            </AutoSuggestBox>
            
        </Grid>


        
        <ScrollViewer Grid.Row="2">
            <!-- Endpoint List - Card View -->

            <Grid Margin="0,0,8,0" HorizontalAlignment="Stretch">
                <GridView ItemsSource="{x:Bind ViewModel.Endpoints, Mode=OneWay}"
                          SelectionMode="None"
                          IsItemClickEnabled="False">
                    <GridView.ItemContainerStyle>
                        <Style TargetType="GridViewItem" BasedOn="{StaticResource DefaultGridViewItemStyle}">
                            <Setter Property="Margin" Value="8"/>
                        </Style>
                    </GridView.ItemContainerStyle>
                    
                    <GridView.ItemTemplate>
                        <DataTemplate x:DataType="local:MidiEndpointDisplayItem">
                            <Grid Background="{StaticResource LayerFillColorDefaultBrush}"
                                  Width="350"
                                  Height="280"
                                  CornerRadius="{StaticResource ControlCornerRadius}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="90" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>

                                <Image Grid.Column="0"
                                       Grid.RowSpan="2"
                                       Margin="16,16,16,16"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Top"
                                       Source="{x:Bind SmallImage}"
                                       Stretch="Uniform">
                                    
                                </Image>

                                <!-- Name -->
                                <TextBlock Grid.Row="0"
                                           Grid.Column="1"
                                           Text="{x:Bind Name}" 
                                           Style="{StaticResource EndpointCardNameStyle}" />

                                <!-- Description -->
                                <TextBlock Grid.Row="1" 
                                           Grid.Column="1"
                                           VerticalAlignment="Top"
                                           Text="{x:Bind Description}"
                                           Style="{StaticResource EndpointCardDescriptionStyle}" />


                                <Grid Grid.Column="0"
                                      Grid.ColumnSpan="2"
                                      Grid.Row="2"
                                      Margin="16,16,16,16">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>

                                    
                                    <!-- MIDI 1 Input Ports -->
                                    <DropDownButton Grid.Row="0"
                                                    HorizontalAlignment="Stretch"
                                                    HorizontalContentAlignment="Left"
                                                    Margin="4">
                                        <DropDownButton.Content>
                                            <TextBlock Style="{StaticResource SmallPropertyLabel}"
                                                       HorizontalAlignment="Left">
                                                <Run Text="{x:Bind CountMidi1InputPorts, Mode=OneWay}" />
                                                <Run Text="MIDI 1.0 Input Ports (Sources)" />
                                            </TextBlock>
                                        </DropDownButton.Content>
                                        <DropDownButton.Flyout>
                                            <Flyout>
                                                <Grid>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="*" />
                                                    </Grid.RowDefinitions>
                                                    <TextBlock Text="MIDI 1.0 Input Ports (Sources)"
                                                               Style="{StaticResource SmallPropertyLabel}"
                                                               FontWeight="Bold"
                                                               Grid.Row="0"/>

                                                    <ListBox Grid.Row="1" 
                                                             ItemsSource="{x:Bind Midi1InputPorts}"
                                                             ItemTemplate="{StaticResource Midi1InputPortTemplate}"
                                                             SelectionMode="Single">
                                                    </ListBox>
                                                </Grid>
                                            </Flyout>
                                        </DropDownButton.Flyout>
                                    </DropDownButton>

                                    <!-- MIDI 1 Output Ports -->
                                    <DropDownButton Grid.Row="1"
                                                    HorizontalContentAlignment="Left"
                                                    HorizontalAlignment="Stretch"
                                                    Margin="4">
                                        <DropDownButton.Content>
                                            <TextBlock Style="{StaticResource SmallPropertyLabel}"
                                                       HorizontalAlignment="Left">
                                                <Run Text="{x:Bind CountMidi1OutputPorts, Mode=OneWay}" />
                                                <Run Text="MIDI 1.0 Output Ports (Destinations)" />
                                            </TextBlock>
                                        </DropDownButton.Content>
                                        <DropDownButton.Flyout>
                                            <Flyout>
                                                <ItemsControl ItemsSource="{x:Bind Midi1OutputPorts}"
                                                              ItemTemplate="{StaticResource Midi1OutputPortTemplate}">
                                                </ItemsControl>
                                            </Flyout>
                                        </DropDownButton.Flyout>
                                    </DropDownButton>


                                </Grid>

                                <!-- Actions -->

                                <Grid Grid.Row="3"
                                      Grid.Column="0"
                                      Grid.ColumnSpan="2"
                                      Padding="12,8,12,8"
                                        VerticalAlignment="Bottom"
                                        Background="{StaticResource SmokeFillColorDefaultBrush}">
                                    <StackPanel Orientation="Horizontal"
                                                HorizontalAlignment="Right">
                                        <Button Content="View / Edit" Margin="4,8,4,8" />
                                        <Button Content="Monitor" Margin="4,8,4,8" />
                                        <Button Content="..." Margin="4,8,8,8">
                                            <Button.Flyout>
                                                <MenuFlyout>
                                                    <MenuFlyoutItem>Send Program Change</MenuFlyoutItem>
                                                    <MenuFlyoutItem>Send Control Change</MenuFlyoutItem>
                                                    <MenuFlyoutSeparator/>
                                                    <MenuFlyoutItem>Send MIDI Start</MenuFlyoutItem>
                                                    <MenuFlyoutItem>Send MIDI Stop</MenuFlyoutItem>
                                                    <MenuFlyoutSeparator/>
                                                    <MenuFlyoutItem>Send SysEx</MenuFlyoutItem>
                                                    <MenuFlyoutSeparator/>
                                                    <MenuFlyoutItem>Send Test Messages</MenuFlyoutItem>
                                                    <MenuFlyoutItem>MIDI Panic</MenuFlyoutItem>
                                                </MenuFlyout>
                                            </Button.Flyout>
                                        </Button>

                                    </StackPanel>

                                </Grid>
                                    
                                    
                                
                                
                                
                                

                                
                                

                            </Grid>
                        </DataTemplate>
                    </GridView.ItemTemplate>
                    
                </GridView>
                

            </Grid>

            <!-- Endpoint List - List View -->
            
            
            
        </ScrollViewer>

    </Grid>

</Page>

