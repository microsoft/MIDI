<!-- Start Slider  Area -->
<section class="slider-area bg-cover1">
    <!--<p id="testOut"></p>-->
    <div class="slider-wrapper full-padding">
        <div class="container">
            <div class="row">
                <div class="col-lg-9">
                     <div class="slider-carousel owl-carousel">
                        <div class="slider-content wow fadeIn" data-wow-duration="3s">
                            <h1 class="heading-1">Windows MIDI Services is coming to your PC!</h1>
                            <h4 class="heading-4">In-Box 1.0 Release</h4>
                            <h4 class="heading-4">We're rolling out Windows MIDI Services in-box components to supported retail 24h2 and 25h2 builds of Windows 11 throughout February, through Windows Update. This release brings enhanced MIDI 1.0 support (including multi-client) to your PC, and enables MIDI 2.0 infrastructure.<br/>This download is a tool which tells you if Windows MIDI Services is installed and enabled on your PC running the supported retail version of Windows. (Note: Tool is unsigned and your browser will display a warning when downloading).<br/>Check back in late February for the matching SDK and Tools download!</h4>
                            <p>
                            <!-- Download for this PC  -->
                            <a id="download_this_pc_x64" href="https://github.com/microsoft/MIDI/releases/download/enablement-checker/midicheckservice_x64.zip" class="btn-style3 btn wow fadeInDown" data-wow-duration="500ms">Download for Intel/AMD x64 Processors</a>
                            <a id="download_this_pc_arm64" href="https://github.com/microsoft/MIDI/releases/download/enablement-checker/midicheckservice_arm64.zip" class="btn-style3 btn wow fadeInDown" data-wow-duration="500ms">Download for Qualcomm and other Arm Processors</a>
                            </p>
                            <p id="download_all_slider_links" style="display: none">
                            <!-- All downloads. Simple links -->
                            <span style="color:rgb(159, 200, 239)">All downloads: </span>
                            <a id="download_x64" style="color:white" href="https://github.com/microsoft/MIDI/releases/download/enablement-checker/midicheckservice_x64.zip">Download for Intel/AMD x64 Processors</a>
                            &nbsp;|&nbsp;
                            <a id="download_arm64" style="color:white" href="https://github.com/microsoft/MIDI/releases/download/enablement-checker/midicheckservice_arm64.zip">Download for Qualcomm and other Arm Processors</a>
                            &nbsp;|&nbsp;
                            </p>
                    
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- architecture detection -->
<script>
function enableArchitectureSpecificDownloads()
{
    // this doesn't work on firefox, so FF users won't get a recommended download, just both downloads
    navigator.userAgentData.getHighEntropyValues(["architecture", "bitness"])
    .then(ua => 
    {
        var elem_download_this_pc_x64 = document.getElementById("download_this_pc_x64");
        var elem_download_this_pc_arm64 = document.getElementById("download_this_pc_arm64");

        var elem_download_all_slider_links = document.getElementById("download_all_slider_links");
        //var elem_release_notes = document.getElementById("slider_links_release_notes");

        // always display this
        //elem_release_notes.style.display = "block";

        if ((elem_download_this_pc_arm64 != null) && (elem_download_this_pc_x64 != null))
        {
            console.log("enableArchitectureSpecificDownloads: Elements are not null");

            if (navigator.userAgentData.platform === "Windows") 
            {
                console.log("enableArchitectureSpecificDownloads: Platform is Windows");

                if (ua.bitness === '64') 
                {
                    console.log("enableArchitectureSpecificDownloads: Bitness is 64");

                    if (ua.architecture === 'arm') 
                    {
                        console.log("enableArchitectureSpecificDownloads: Arm64 architecture");

                        elem_download_this_pc_x64.remove();
                        elem_download_this_pc_arm64.innerText += " (Recommended for this PC)";

                        elem_download_all_slider_links.style.display = "block";
                        //document.getElementById("download_arm64").innerText += " (recommended for this PC)";

                        console.log("enableArchitectureSpecificDownloads: Finished manipulations for Arm");
                    }
                    else if (ua.architecture === 'x86')
                    {
                        console.log("enableArchitectureSpecificDownloads: x86-64 architecture");

                        elem_download_this_pc_arm64.remove();
                        elem_download_this_pc_x64.innerText += " (Recommended for this PC)";

                        elem_download_all_slider_links.style.display = "block";
                        //document.getElementById("download_x64").innerText += " (recommended for this PC)";

                        console.log("enableArchitectureSpecificDownloads: Finished manipulations for x64");
                    }
                    else
                    {
                        console.error("enableArchitectureSpecificDownloads: Unknown architecture");
                    }
                }
                else
                {
                    console.log("enableArchitectureSpecificDownloads: not 64 bit");

                    // Not 64 bit
                    elem_download_this_pc_x64.style.visibility = 'collapse'; 
                    elem_download_this_pc_arm64.style.visibility = 'collapse';
                }
            }
            else
            {
                console.log("enableArchitectureSpecificDownloads: not Windows");

                // not Windows
                elem_download_this_pc_x64.style.visibility = 'collapse';  
                elem_download_this_pc_arm64.style.visibility = 'collapse';
            }
        }
        else
        {
            // could not find elements
            console.error("enableArchitectureSpecificDownloads: Unable to find elements");
        }
    });
}

window.onload = enableArchitectureSpecificDownloads();

</script>

<!-- End Slider Area -->



