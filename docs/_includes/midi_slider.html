
<!-- architecture detection -->

<script type="text/javascript">
function enableArchitectureSpecificDownloads()
{
    document.getElementById("testOut").innerText = "enableArchitectureSpecificDownloads called";

    // this doesn't work on firefox, so FF users won't get a recommended download, just both downloads
    navigator.userAgentData.getHighEntropyValues(["architecture", "bitness"])
    .then(ua => 
    {
        const download_this_pc_x64 = document.getElementById("download_this_pc_x64");
        const download_this_pc_arm64 = document.getElementById("download_this_pc_arm64");

        if (download_this_pc_arm64 || download_this_pc_x64)
        {
            if (navigator.userAgentData.platform === "Windows") 
            {
                //document.getElementById("testOut").innerText = "Windows";

                if (ua.bitness === '64') 
                {
                    //document.getElementById("testOut").innerText += " 64 bit";

                    if (ua.architecture === 'arm') 
                    {
                        document.getElementById("testOut").innerText += ", arch: Arm";

                        download_this_pc_x64.style.display = 'none';
                        download_this_pc_arm64.innerText += " (recommended for this PC)";

                        document.getElementById("download_arm64").innerText += " (recommended for this PC)";
                    }
                    else if (ua.architecture === 'x86')
                    {
                        document.getElementById("testOut").innerText += ", arch: x86";

                        download_this_pc_arm64.style.display = 'none';
                        download_this_pc_x64.innerText += " (recommended for this PC)";

                        document.getElementById("download_x64").innerText += " (recommended for this PC)";
                    }
                    else
                    {
                        document.getElementById("testOut").innerText += " Unknown: " + ua.architecture;
                    }
                }
                else
                {
                    document.getElementById("testOut").innerText += ", (not 64 bit)";

                    // Not 64 bit
                    download_this_pc_x64.style.display = 'none';  
                    download_this_pc_arm64.style.display = 'none';
                }
            }
            else
            {
                document.getElementById("testOut").innerText += ", (not Windows)";

                // not Windows
                download_this_pc_x64.style.display = 'none';  
                download_this_pc_arm64.style.display = 'none';
            }
        }
        else
        {
            // could not find elements
            document.getElementById("testOut").innerText += " (could not find elements)";
        }
    });
}
</script>


<!-- Start Slider  Area -->
<section class="slider-area bg-cover1">
    <p id="testOut"></p>
    <div class="slider-wrapper full-padding">
        <div class="container">
            <div class="row">
                <div class="col-lg-9">
                     <div class="slider-carousel owl-carousel">
                       {% assign data =  site.data.midi_releases | where: "featured", true %}
                            <!-- TODO: This must only process one release. Can't have two+ in this -->
                         {% for release in data %}
                           <div class="slider-content wow fadeIn" data-wow-duration="3s">
                             <h1 class="heading-1">{{release.title}}</h1>
                             <h4 class="heading-4">{{release.version}}</h4>
                             <h4 class="heading-4">{{release.description}}</h4>
                             <p>
                                <!-- Download for this PC  -->
                                <a id="download_this_pc_x64" href="{{release.link_x64}}" class="btn-style3 btn wow fadeInDown" data-wow-duration="500ms">{{release.label_x64}}</a>
                                <a id="download_this_pc_arm64" href="{{release.link_arm64}}" class="btn-style3 btn wow fadeInDown" data-wow-duration="500ms">{{release.label_arm64}}</a>
                             </p>
                             <p>
                                <!-- All downloads. Simple links -->
                                <span>All downloads: </span>
                                <a id="download_x64" style="color:white" href="{{release.link_x64}}">{{release.label_x64}}</a>
                                &nbsp;|&nbsp;
                                <a id="download_arm64" style="color:white" href="{{release.link_arm64}}">{{release.label_arm64}}</a>
                             </p>
                           </div>
                        {% endfor %}
                    </div>

                    <script type="text/javascript">
                    enableArchitectureSpecificDownloads();
                    </script>

                </div>
            </div>
        </div>
    </div>
</section>
<!-- End Slider Area -->



